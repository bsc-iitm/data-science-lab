<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RAG – Data Science Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week-7/3_VectorDBs.html" rel="next">
<link href="../week-7/1_Revisiting_langchain.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-46f4cc9626f044588a66931b604fc9c8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f5b8582305394ab3d0231d2900294800.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-d99f1631218ff9e9c1793c24613d371a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-f5b8582305394ab3d0231d2900294800.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../week-7/1_Revisiting_langchain.html">Week 7</a></li><li class="breadcrumb-item"><a href="../week-7/2_RAG.html">RAG</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/iit_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../week-1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week-1</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../week-1/module-1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module-1- NumPy and Matplotlib</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting Simple Curves</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampling from Distributions, Bar Plots, Histograms and Scatter plots</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NumPy Arrays</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/module-1/nb-6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contour Plots, 3D Plots, Optimisation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Pandas</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/pandas/apply_and_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apply and Map</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/pandas/compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compare</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/pandas/introduction_to_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-1/pandas/PivotTable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PivotTable</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../week-6/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 1: Introduction to Prompt Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 2: Techniques in Prompting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 3: Applications of Prompt Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 4: Introduction to LLM Platforms</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 5: Getting Started with OpenAI API</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 6: Hands-on with OpenAI API</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 7: Working with Text Completion in OpenAI</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 8: Evaluating Prompt Quality and Output Reliability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 9: Introduction to LangChain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 10: Core Components of LangChain – LLMs, PromptTemplates, OutputParsers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 11: LangChain Chains – Sequential, SimpleSequentialChain, RouterChain</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 12: LangChain Memory – Making LLMs Remember Context</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-6/Module13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Module 13: PromptTemplates in Depth – Partial Templates, Nesting, Debugging</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 10</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/1 Time_Series_Analysis_with_Pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Date Time Index</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/2 Time_Resampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time Resampling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/3 Classical_decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Classical_decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/4 STL_Decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 STL_Decomposition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/5 Stationarity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Stationarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-10/6 make_data_stationary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Make data stationary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-2/week-2-reference-notebook_v1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Objective</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Pytorch</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-3/pytorch/2 ANN using Pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numpy array to Tensor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-3/pytorch/3 CNN using Pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 CNN using Pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-3/pytorch/4 RNN using pytorch.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 RNN using pytorch</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-3/pytorch/Pytorch_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DL workshop on PyTorch</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-4/Guide_to_Image_Manipulation_with_Pillow_and_OpenCV.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Practical Guide to Image Manipulation with Pillow and OpenCV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-4/Loading_Images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-4/preprocessing_images.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">— Data Augmentation Examples (PyTorch v2) —</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-4/Transfer_Learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transfer Learning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Week 5</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-5/Datasets_and_Tokenizers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to the Hugging Face Ecosystem: Datasets and Tokenizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-5/Fine_tuning_hands-on.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fine Tuning Hands On</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-5/Summarization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-5/W5_Fine_TuningBERT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">W5 Fine TuningBERT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-5/W5_L2_FineTuningGPT2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">W5 L2 FineTuningGPT2</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-7/1_Revisiting_langchain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LangChain Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-7/2_RAG.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">RAG</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week-7/3_VectorDBs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Vector Databases</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#rag-steps" id="toc-rag-steps" class="nav-link active" data-scroll-target="#rag-steps">RAG steps</a>
  <ul class="collapse">
  <li><a href="#using-a-simple-text" id="toc-using-a-simple-text" class="nav-link" data-scroll-target="#using-a-simple-text">1.1 Using a simple text</a></li>
  <li><a href="#using-a-txt-file" id="toc-using-a-txt-file" class="nav-link" data-scroll-target="#using-a-txt-file">1.2 Using a txt file</a>
  <ul class="collapse">
  <li><a href="#document_loaders" id="toc-document_loaders" class="nav-link" data-scroll-target="#document_loaders"><code>document_loaders</code></a></li>
  </ul></li>
  <li><a href="#using-a-pdf-file" id="toc-using-a-pdf-file" class="nav-link" data-scroll-target="#using-a-pdf-file">1.3 Using a pdf file</a></li>
  <li><a href="#mixing-different-file-types" id="toc-mixing-different-file-types" class="nav-link" data-scroll-target="#mixing-different-file-types">1.4 Mixing Different File Types</a></li>
  </ul></li>
  <li><a href="#split-the-text" id="toc-split-the-text" class="nav-link" data-scroll-target="#split-the-text">2.Split the text</a></li>
  <li><a href="#produce-embeddings-for-splits" id="toc-produce-embeddings-for-splits" class="nav-link" data-scroll-target="#produce-embeddings-for-splits">3.Produce Embeddings for splits</a></li>
  <li><a href="#store-the-embeddings-in-a-vectordb" id="toc-store-the-embeddings-in-a-vectordb" class="nav-link" data-scroll-target="#store-the-embeddings-in-a-vectordb">4.Store the embeddings in a vectorDB</a>
  <ul class="collapse">
  <li><a href="#access-stored-documents-optional" id="toc-access-stored-documents-optional" class="nav-link" data-scroll-target="#access-stored-documents-optional">Access stored documents (Optional)</a></li>
  <li><a href="#save-reload-faiss-optional" id="toc-save-reload-faiss-optional" class="nav-link" data-scroll-target="#save-reload-faiss-optional">Save &amp; reload FAISS (Optional)</a></li>
  <li><a href="#retrievalqa" id="toc-retrievalqa" class="nav-link" data-scroll-target="#retrievalqa"><code>RetrievalQA</code></a></li>
  <li><a href="#invokequery-query" id="toc-invokequery-query" class="nav-link" data-scroll-target="#invokequery-query"><code>.invoke({"query": query})</code></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/bsc-iitm/data-science-lab/blob/master/week-7/2_RAG.ipynb" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bsc-iitm/data-science-lab/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/bsc-iitm/data-science-lab/blob/master/week-7/2_RAG.ipynb" target="_blank" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div><div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://discourse.onlinedegree.iitm.ac.in/"><i class="bi bi-chat-square-dots-fill"></i>Discussion Forum</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../week-7/1_Revisiting_langchain.html">Week 7</a></li><li class="breadcrumb-item"><a href="../week-7/2_RAG.html">RAG</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">RAG</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Retrieval-Augmented Generation (RAG) is a technique where you give the LLM extra context from external data sources (like PDFs, websites, or text files) so it can answer questions better — especially when the info is not present in the model’s training data.</p>
<p>Informally, imagine the LLM is like a student answering questions.</p>
<p>Traditional LLM: Answers from memory</p>
<p>RAG LLM: First opens a textbook, goes to the right chapter, then answers.</p>
<p>We will use OpenAI and langchain to demonstrate RAG.</p>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>openai_api_key <span class="op">=</span> <span class="st">'&lt;your_api_key&gt;'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755529496387,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:11411,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="aff0aaab-b485-4b6b-edc5-5ed4fe2d6f51">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="op">!</span>pip install langchain<span class="op">-</span>openai</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Collecting langchain-openai

  Downloading langchain_openai-0.3.30-py3-none-any.whl.metadata (2.4 kB)

Requirement already satisfied: langchain-core&lt;1.0.0,&gt;=0.3.74 in /usr/local/lib/python3.11/dist-packages (from langchain-openai) (0.3.74)

Requirement already satisfied: openai&lt;2.0.0,&gt;=1.99.9 in /usr/local/lib/python3.11/dist-packages (from langchain-openai) (1.99.9)

Requirement already satisfied: tiktoken&lt;1,&gt;=0.7 in /usr/local/lib/python3.11/dist-packages (from langchain-openai) (0.11.0)

Requirement already satisfied: langsmith&gt;=0.3.45 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (0.4.14)

Requirement already satisfied: tenacity!=8.4.0,&lt;10.0.0,&gt;=8.1.0 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (9.1.2)

Requirement already satisfied: jsonpatch&lt;2.0,&gt;=1.33 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (1.33)

Requirement already satisfied: PyYAML&gt;=5.3 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (6.0.2)

Requirement already satisfied: typing-extensions&gt;=4.7 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (4.14.1)

Requirement already satisfied: packaging&gt;=23.2 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (25.0)

Requirement already satisfied: pydantic&gt;=2.7.4 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (2.11.7)

Requirement already satisfied: anyio&lt;5,&gt;=3.5.0 in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (4.10.0)

Requirement already satisfied: distro&lt;2,&gt;=1.7.0 in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (1.9.0)

Requirement already satisfied: httpx&lt;1,&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (0.28.1)

Requirement already satisfied: jiter&lt;1,&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (0.10.0)

Requirement already satisfied: sniffio in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (1.3.1)

Requirement already satisfied: tqdm&gt;4 in /usr/local/lib/python3.11/dist-packages (from openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (4.67.1)

Requirement already satisfied: regex&gt;=2022.1.18 in /usr/local/lib/python3.11/dist-packages (from tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai) (2024.11.6)

Requirement already satisfied: requests&gt;=2.26.0 in /usr/local/lib/python3.11/dist-packages (from tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai) (2.32.3)

Requirement already satisfied: idna&gt;=2.8 in /usr/local/lib/python3.11/dist-packages (from anyio&lt;5,&gt;=3.5.0-&gt;openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (3.10)

Requirement already satisfied: certifi in /usr/local/lib/python3.11/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (2025.8.3)

Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.11/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (1.0.9)

Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.11/dist-packages (from httpcore==1.*-&gt;httpx&lt;1,&gt;=0.23.0-&gt;openai&lt;2.0.0,&gt;=1.99.9-&gt;langchain-openai) (0.16.0)

Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.11/dist-packages (from jsonpatch&lt;2.0,&gt;=1.33-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (3.0.0)

Requirement already satisfied: orjson&gt;=3.9.14 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (3.11.2)

Requirement already satisfied: requests-toolbelt&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (1.0.0)

Requirement already satisfied: zstandard&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.3.45-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (0.23.0)

Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (0.7.0)

Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (2.33.2)

Requirement already satisfied: typing-inspection&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic&gt;=2.7.4-&gt;langchain-core&lt;1.0.0,&gt;=0.3.74-&gt;langchain-openai) (0.4.1)

Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from requests&gt;=2.26.0-&gt;tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai) (3.4.3)

Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests&gt;=2.26.0-&gt;tiktoken&lt;1,&gt;=0.7-&gt;langchain-openai) (2.5.0)

Downloading langchain_openai-0.3.30-py3-none-any.whl (74 kB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">74.4/74.4 kB</span> <span class="ansi-red-fg">2.8 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Installing collected packages: langchain-openai

Successfully installed langchain-openai-0.3.30
</pre>
</div>
</div>
</div>
<div id="cell-5" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="badc8cc6-5600-4c03-9141-f7edb8d93163">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> langchain_openai <span class="im">import</span> ChatOpenAI</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">import</span> os</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a>os.environ[<span class="st">"OPENAI_API_KEY"</span>] <span class="op">=</span> openai_api_key</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>llm <span class="op">=</span> ChatOpenAI(model<span class="op">=</span><span class="st">"gpt-3.5-turbo"</span>, <span class="co">#or gpt-4</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>                 temperature<span class="op">=</span><span class="fl">0.7</span>, <span class="co">#optional to pass</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>                <span class="co"># openai_api_key=openai_api_key #could also be passed here if you do not want to set the environemnt variable</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>    )</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># Now you can use it in a chain, or call it directly as below</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>response <span class="op">=</span> llm.invoke(<span class="st">"When was Acme Inc. founded?"</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="bu">print</span>(response.content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There have been several companies with the name Acme Inc. founded throughout history, so it depends on which specific company you are referring to. Can you please provide more context or details?</code></pre>
</div>
</div>
<p>Sample outputs obtained from the above: - “It is unclear which specific company named Acme Inc.&nbsp;you are referring to, as there are many companies with similar names. Can you please provide more information or context so I can accurately answer your question?”</p>
<ul>
<li>“It is not possible to determine the specific founding date of Acme Inc.&nbsp;as it is a fictional company commonly used in cartoons, comic strips, and other forms of media. The name”Acme” is often used as a generic placeholder for a company in popular culture.”</li>
</ul>
<p>Other questions that may be asked:</p>
<ul>
<li>What new product line was launched in 2024 in Acme Inc?</li>
<li>How frequently does the HR team of Acme Inc meet and what do they assess?</li>
</ul>
<p>If it is a very specific or new company, the LLM may or may not be able to answer correctly. Hence, we will use RAG.</p>
<section id="rag-steps" class="level1">
<h1>RAG steps</h1>
<ol type="1">
<li>Read the data for retrieval</li>
<li>Split the text</li>
<li>Produce Embeddings for splits</li>
<li>Store the embeddings in a vectorDB</li>
<li>Create Retriever to retrieve the embeddings from the VectorDB</li>
<li>Combine the LLM and the retriever, and produce results.</li>
</ol>
<p>#1.Read the data for retrieval</p>
<p>Before doing RAG, we need data. There are different ways to read the data:</p>
<p>1.1. Using simple text<br>
1.2. Using a text file<br>
1.3. Using a pdf file</p>
<section id="using-a-simple-text" class="level2">
<h2 class="anchored" data-anchor-id="using-a-simple-text">1.1 Using a simple text</h2>
<p>###<code>Document</code> class</p>
<p>LangChain wraps all content in Document objects, which hold both text and optional metadata.</p>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">from</span> langchain.schema <span class="im">import</span> Document</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>doc1 <span class="op">=</span> Document(page_content<span class="op">=</span><span class="st">"This is the first document"</span>, metadata<span class="op">=</span>{<span class="st">"source"</span>: <span class="st">"file1.txt"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530341721,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:48,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="b201cd43-c7af-4067-8e02-93059d7e740f">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>doc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Document(metadata={'source': 'file1.txt'}, page_content='This is the first document')</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530489771,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:99,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="db90e5c9-1086-4c23-f452-40bbf71f599f">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>doc1.page_content</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>'This is the first document'</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530495850,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:96,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="72c3581a-db42-47db-b219-de9ddf62717f">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>doc1.metadata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>{'source': 'file1.txt'}</code></pre>
</div>
</div>
<p>Each doc is a Document object with attributes: page_content and metadata</p>
</section>
<section id="using-a-txt-file" class="level2">
<h2 class="anchored" data-anchor-id="using-a-txt-file">1.2 Using a txt file</h2>
<section id="document_loaders" class="level3">
<h3 class="anchored" data-anchor-id="document_loaders"><code>document_loaders</code></h3>
<p>Loaders help you load documents from .txt, .pdf, .csv, URLs, etc.</p>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530420289,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:10100,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="9f474aa8-0911-417a-8077-08d101c1c8fd">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="op">!</span>pip install langchain langchain<span class="op">-</span>community</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Requirement already satisfied: langchain in /usr/local/lib/python3.11/dist-packages (0.3.27)

Collecting langchain-community

  Downloading langchain_community-0.3.27-py3-none-any.whl.metadata (2.9 kB)

Requirement already satisfied: langchain-core&lt;1.0.0,&gt;=0.3.72 in /usr/local/lib/python3.11/dist-packages (from langchain) (0.3.74)

Requirement already satisfied: langchain-text-splitters&lt;1.0.0,&gt;=0.3.9 in /usr/local/lib/python3.11/dist-packages (from langchain) (0.3.9)

Requirement already satisfied: langsmith&gt;=0.1.17 in /usr/local/lib/python3.11/dist-packages (from langchain) (0.4.14)

Requirement already satisfied: pydantic&lt;3.0.0,&gt;=2.7.4 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.11.7)

Requirement already satisfied: SQLAlchemy&lt;3,&gt;=1.4 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.0.43)

Requirement already satisfied: requests&lt;3,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from langchain) (2.32.3)

Requirement already satisfied: PyYAML&gt;=5.3 in /usr/local/lib/python3.11/dist-packages (from langchain) (6.0.2)

Requirement already satisfied: aiohttp&lt;4.0.0,&gt;=3.8.3 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (3.12.15)

Requirement already satisfied: tenacity!=8.4.0,&lt;10,&gt;=8.1.0 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (9.1.2)

Collecting dataclasses-json&lt;0.7,&gt;=0.5.7 (from langchain-community)

  Downloading dataclasses_json-0.6.7-py3-none-any.whl.metadata (25 kB)

Collecting pydantic-settings&lt;3.0.0,&gt;=2.4.0 (from langchain-community)

  Downloading pydantic_settings-2.10.1-py3-none-any.whl.metadata (3.4 kB)

Collecting httpx-sse&lt;1.0.0,&gt;=0.4.0 (from langchain-community)

  Downloading httpx_sse-0.4.1-py3-none-any.whl.metadata (9.4 kB)

Requirement already satisfied: numpy&gt;=1.26.2 in /usr/local/lib/python3.11/dist-packages (from langchain-community) (2.0.2)

Requirement already satisfied: aiohappyeyeballs&gt;=2.5.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (2.6.1)

Requirement already satisfied: aiosignal&gt;=1.4.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (1.4.0)

Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (25.3.0)

Requirement already satisfied: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (1.7.0)

Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (6.6.4)

Requirement already satisfied: propcache&gt;=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (0.3.2)

Requirement already satisfied: yarl&lt;2.0,&gt;=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp&lt;4.0.0,&gt;=3.8.3-&gt;langchain-community) (1.20.1)

Collecting marshmallow&lt;4.0.0,&gt;=3.18.0 (from dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community)

  Downloading marshmallow-3.26.1-py3-none-any.whl.metadata (7.3 kB)

Collecting typing-inspect&lt;1,&gt;=0.4.0 (from dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community)

  Downloading typing_inspect-0.9.0-py3-none-any.whl.metadata (1.5 kB)

Requirement already satisfied: jsonpatch&lt;2.0,&gt;=1.33 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.72-&gt;langchain) (1.33)

Requirement already satisfied: typing-extensions&gt;=4.7 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.72-&gt;langchain) (4.14.1)

Requirement already satisfied: packaging&gt;=23.2 in /usr/local/lib/python3.11/dist-packages (from langchain-core&lt;1.0.0,&gt;=0.3.72-&gt;langchain) (25.0)

Requirement already satisfied: httpx&lt;1,&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.1.17-&gt;langchain) (0.28.1)

Requirement already satisfied: orjson&gt;=3.9.14 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.1.17-&gt;langchain) (3.11.2)

Requirement already satisfied: requests-toolbelt&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.1.17-&gt;langchain) (1.0.0)

Requirement already satisfied: zstandard&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from langsmith&gt;=0.1.17-&gt;langchain) (0.23.0)

Requirement already satisfied: annotated-types&gt;=0.6.0 in /usr/local/lib/python3.11/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain) (0.7.0)

Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.11/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain) (2.33.2)

Requirement already satisfied: typing-inspection&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from pydantic&lt;3.0.0,&gt;=2.7.4-&gt;langchain) (0.4.1)

Collecting python-dotenv&gt;=0.21.0 (from pydantic-settings&lt;3.0.0,&gt;=2.4.0-&gt;langchain-community)

  Downloading python_dotenv-1.1.1-py3-none-any.whl.metadata (24 kB)

Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain) (3.4.3)

Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain) (3.10)

Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain) (2.5.0)

Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests&lt;3,&gt;=2-&gt;langchain) (2025.8.3)

Requirement already satisfied: greenlet&gt;=1 in /usr/local/lib/python3.11/dist-packages (from SQLAlchemy&lt;3,&gt;=1.4-&gt;langchain) (3.2.4)

Requirement already satisfied: anyio in /usr/local/lib/python3.11/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&gt;=0.1.17-&gt;langchain) (4.10.0)

Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.11/dist-packages (from httpx&lt;1,&gt;=0.23.0-&gt;langsmith&gt;=0.1.17-&gt;langchain) (1.0.9)

Requirement already satisfied: h11&gt;=0.16 in /usr/local/lib/python3.11/dist-packages (from httpcore==1.*-&gt;httpx&lt;1,&gt;=0.23.0-&gt;langsmith&gt;=0.1.17-&gt;langchain) (0.16.0)

Requirement already satisfied: jsonpointer&gt;=1.9 in /usr/local/lib/python3.11/dist-packages (from jsonpatch&lt;2.0,&gt;=1.33-&gt;langchain-core&lt;1.0.0,&gt;=0.3.72-&gt;langchain) (3.0.0)

Collecting mypy-extensions&gt;=0.3.0 (from typing-inspect&lt;1,&gt;=0.4.0-&gt;dataclasses-json&lt;0.7,&gt;=0.5.7-&gt;langchain-community)

  Downloading mypy_extensions-1.1.0-py3-none-any.whl.metadata (1.1 kB)

Requirement already satisfied: sniffio&gt;=1.1 in /usr/local/lib/python3.11/dist-packages (from anyio-&gt;httpx&lt;1,&gt;=0.23.0-&gt;langsmith&gt;=0.1.17-&gt;langchain) (1.3.1)

Downloading langchain_community-0.3.27-py3-none-any.whl (2.5 MB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">2.5/2.5 MB</span> <span class="ansi-red-fg">33.4 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Downloading dataclasses_json-0.6.7-py3-none-any.whl (28 kB)

Downloading httpx_sse-0.4.1-py3-none-any.whl (8.1 kB)

Downloading pydantic_settings-2.10.1-py3-none-any.whl (45 kB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">45.2/45.2 kB</span> <span class="ansi-red-fg">2.8 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Downloading marshmallow-3.26.1-py3-none-any.whl (50 kB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">50.9/50.9 kB</span> <span class="ansi-red-fg">3.4 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Downloading python_dotenv-1.1.1-py3-none-any.whl (20 kB)

Downloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)

Downloading mypy_extensions-1.1.0-py3-none-any.whl (5.0 kB)

Installing collected packages: python-dotenv, mypy-extensions, marshmallow, httpx-sse, typing-inspect, pydantic-settings, dataclasses-json, langchain-community

Successfully installed dataclasses-json-0.6.7 httpx-sse-0.4.1 langchain-community-0.3.27 marshmallow-3.26.1 mypy-extensions-1.1.0 pydantic-settings-2.10.1 python-dotenv-1.1.1 typing-inspect-0.9.0
</pre>
</div>
</div>
</div>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">from</span> langchain.document_loaders <span class="im">import</span> TextLoader</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co"># If the above doesnt work, use</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co"># from langchain_community.document_loaders import TextLoader</span></span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>loader <span class="op">=</span> TextLoader(<span class="st">"RAG_file.txt"</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a>docs1 <span class="op">=</span> loader.load()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530466848,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:68,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="1c0ff3a3-3e10-4c0c-f7c8-29ffa696bfef">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># docs1 is a list of Document objects</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="cf">for</span> doc <span class="kw">in</span> docs1:</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="bu">print</span>(doc.page_content)   <span class="co"># The text</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="bu">print</span>(doc.metadata)       <span class="co"># File name, etc.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Acme Inc. was founded in 1987 in Helsinki, Finland. It specializes in anti-gravity footwear and rocket-powered pogo sticks.

In 2024, Acme released a new product line: "Jet Sneakers", designed for low-orbit recreational use.

As per internal policy, Acme's HR team meets every 2 weeks to assess wellness metrics of staff based on holographic surveys.

{'source': 'RAG_file.txt'}</code></pre>
</div>
</div>
<p>Even when loading a single .txt file, TextLoader.load() returns a list of one Document object — for consistency across all loaders in LangChain.</p>
<p>LangChain is designed to treat everything as a list of documents, whether you load:</p>
<p>one .txt file or multiple files at once.</p>
</section>
</section>
<section id="using-a-pdf-file" class="level2">
<h2 class="anchored" data-anchor-id="using-a-pdf-file">1.3 Using a pdf file</h2>
<div id="cell-25" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530666707,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:5533,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="dffb1f77-5092-49dc-fb21-16f0ed20784f">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="op">!</span>pip install pypdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Collecting pypdf

  Downloading pypdf-6.0.0-py3-none-any.whl.metadata (7.1 kB)

Downloading pypdf-6.0.0-py3-none-any.whl (310 kB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">310.5/310.5 kB</span> <span class="ansi-red-fg">5.3 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Installing collected packages: pypdf

Successfully installed pypdf-6.0.0
</pre>
</div>
</div>
</div>
<div id="cell-26" class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">from</span> langchain.document_loaders <span class="im">import</span> PyPDFLoader</span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a>loader <span class="op">=</span> PyPDFLoader(<span class="st">"RAG_file.pdf"</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>docs2 <span class="op">=</span> loader.load()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755530677110,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:47,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="efb2d64f-c381-4d52-a7b4-4985bdf13e2d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># again docs2 is a list of Document objects</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="cf">for</span> doc <span class="kw">in</span> docs2:</span>
<span id="cb18-3"><a href="#cb18-3"></a>    <span class="bu">print</span>(doc.page_content)   <span class="co"># The text</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="bu">print</span>(doc.metadata)       <span class="co"># File name, etc.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Acme Inc. was founded in 1987 in Helsinki, Finland. It specializes in anti-gravity footwear and
rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers",
designed for low-orbit recreational use. As per internal policy, Acme's HR team meets every 2
weeks to assess wellness metrics of staff based on holographic surveys.
{'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}</code></pre>
</div>
</div>
<p>Note: - We can also read csv files using <code>CSVLoader</code> from <code>langchain.document_loaders</code> or <code>langchain_community.document_loaders</code>. - We can also read from html files using <code>UnstructuredHTMLLoader</code> from <code>langchain.document_loaders</code> or <code>langchain_community.document_loaders</code>. - We can also read from online PDF files using <code>OnlinePDFLoader</code> from <code>langchain.document_loaders</code> or <code>langchain_community.document_loaders</code>.</p>
</section>
<section id="mixing-different-file-types" class="level2">
<h2 class="anchored" data-anchor-id="mixing-different-file-types">1.4 Mixing Different File Types</h2>
<p>You can load different formats separately and then combine them</p>
<div id="cell-30" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Assuming file1, file2, file3, file4 are available</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># from langchain.document_loaders import TextLoader, PyPDFLoader, CSVLoader, UnstructuredHTMLLoader</span></span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co"># # Loaders for different file types</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co"># txt_docs = TextLoader("file1.txt").load()</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># pdf_docs = PyPDFLoader("file2.pdf").load()</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># csv_docs = CSVLoader("file3.csv").load()</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co"># html_docs = UnstructuredHTMLLoader("file4.html").load()</span></span>
<span id="cb20-9"><a href="#cb20-9"></a></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co"># # Merge all into one list</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co"># all_docs = txt_docs + pdf_docs + csv_docs + html_docs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>all_docs is just a list of Document objects → ready for splitting, embedding, and vector storage.</p>
</section>
</section>
<section id="split-the-text" class="level1">
<h1>2.Split the text</h1>
<p>LLMs have token limits, so long files need to be split.</p>
<div id="cell-33" class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">from</span> langchain.text_splitter <span class="im">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a>splitter <span class="op">=</span> RecursiveCharacterTextSplitter(chunk_size<span class="op">=</span><span class="dv">100</span>, chunk_overlap<span class="op">=</span><span class="dv">10</span>) <span class="co">#or 300 and 50 resp</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-34" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>chunks <span class="op">=</span> splitter.split_documents(docs2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755533233961,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:322,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="8dd56595-6e9b-4d25-8fe5-0e17dda74327">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>chunks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[Document(metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='Acme Inc. was founded in 1987 in Helsinki, Finland. It specializes in anti-gravity footwear and'),
 Document(metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers",'),
 Document(metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content="designed for low-orbit recreational use. As per internal policy, Acme's HR team meets every 2"),
 Document(metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='weeks to assess wellness metrics of staff based on holographic surveys.')]</code></pre>
</div>
</div>
<p>Like <code>split_documents()</code>, ther is also a function <code>split_text()</code> which can directly split the text. Let me use that below and show the effect of the parameters <code>chunk_size</code> and <code>chunk_overlap</code></p>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755533236354,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:26,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="05cb554e-b50b-4469-b308-ddd9abcb56c0">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="im">from</span> langchain.text_splitter <span class="im">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>splitter <span class="op">=</span> RecursiveCharacterTextSplitter(chunk_size<span class="op">=</span><span class="dv">300</span>, chunk_overlap<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>chunks1 <span class="op">=</span> splitter.split_text(<span class="st">"Very long document text here..."</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>chunks1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>['Very long document text here...']</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755533254281,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:31,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="7b96ffce-7a8e-46b3-ca08-b63690d29de7">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="im">from</span> langchain.text_splitter <span class="im">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a>splitter <span class="op">=</span> RecursiveCharacterTextSplitter(chunk_size<span class="op">=</span><span class="dv">3</span>, chunk_overlap<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>chunks2 <span class="op">=</span> splitter.split_text(<span class="st">"Very long document text here..."</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>chunks2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>['Ver',
 'ry',
 'lo',
 'ong',
 'do',
 'ocu',
 'ume',
 'ent',
 'te',
 'ext',
 'he',
 'ere',
 'e..',
 '..']</code></pre>
</div>
</div>
</section>
<section id="produce-embeddings-for-splits" class="level1">
<h1>3.Produce Embeddings for splits</h1>
<p>For each chunk, we generate embeddings, which are numerical vectors that capture semantic meaning, such that,</p>
<ul>
<li><p>For similar texts, embeddings are closeby.</p></li>
<li><p>And for dissimilar texts, embeddings are far apart.</p></li>
</ul>
<div id="cell-40" class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="im">from</span> langchain_openai <span class="im">import</span> OpenAIEmbeddings</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a>embedding_model <span class="op">=</span> OpenAIEmbeddings()</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co"># The following extracts the text from each Document chunk, and then converts each chunk into a vector (list of floats).</span></span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a>vectors <span class="op">=</span> embedding_model.embed_documents([doc.page_content <span class="cf">for</span> doc <span class="kw">in</span> chunks])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755533758363,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:66,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="4b430500-53be-49bc-9d86-b4183a2c9ab7">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="bu">len</span>(vectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>4</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755533761058,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:65,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="b2cf3d8c-fc1f-49a3-ab82-b58b3732a087">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="bu">len</span>(vectors[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>1536</code></pre>
</div>
</div>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># vectors[0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="store-the-embeddings-in-a-vectordb" class="level1">
<h1>4.Store the embeddings in a vectorDB</h1>
<p>The embeddings (and chunks) are stored in a vector database (FAISS, Pinecone, Weaviate, Chroma, etc.).</p>
<p>This lets us search semantically, not just by keywords.</p>
<p>(Later, when a user asks a query, the query itself is embedded. DB finds the nearest chunk embeddings and retrieves relevant chunks.)</p>
<p>In this demo, we will be using FAISS VectorDB.</p>
<p>FAISS stands for <strong>Facebook AI Similarity Search</strong></p>
<p>Open-source library from Meta (Facebook AI).</p>
<p>It is optimized for fast similarity search in high-dimensional vectors (like embeddings).</p>
<p>It is used for:</p>
<ul>
<li>Nearest neighbor search</li>
<li>Clustering</li>
<li>Efficient retrieval in RAG pipelines</li>
</ul>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755534041019,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:8153,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="7ffb6ca0-ebc6-4eba-b41b-26265611a297">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="op">!</span>pip install faiss<span class="op">-</span>cpu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>Collecting faiss-cpu

  Downloading faiss_cpu-1.12.0-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (5.1 kB)

Requirement already satisfied: numpy&lt;3.0,&gt;=1.25.0 in /usr/local/lib/python3.11/dist-packages (from faiss-cpu) (2.0.2)

Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from faiss-cpu) (25.0)

Downloading faiss_cpu-1.12.0-cp311-cp311-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (31.4 MB)

   <span class="ansi-bright-black-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">31.4/31.4 MB</span> <span class="ansi-red-fg">48.3 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>

Installing collected packages: faiss-cpu

Successfully installed faiss-cpu-1.12.0
</pre>
</div>
</div>
</div>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="im">from</span> langchain.vectorstores <span class="im">import</span> FAISS</span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a>vectorstore <span class="op">=</span> FAISS.from_documents(chunks, embedding_model)</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co"># This stores both embeddings and data together.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755534110961,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:48,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="b9039976-e42d-4180-ac6c-658f07c4ff49">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>vectorstore</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;langchain_community.vectorstores.faiss.FAISS at 0x7d69e899fd10&gt;</code></pre>
</div>
</div>
<section id="access-stored-documents-optional" class="level3">
<h3 class="anchored" data-anchor-id="access-stored-documents-optional">Access stored documents (Optional)</h3>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755538457164,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:67,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="b630e21a-cb88-4019-a9e0-6911012275c8">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Get all documents back (but embeddings are inside the FAISS index)</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>all_docs <span class="op">=</span> vectorstore.docstore._dict</span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="cf">for</span> doc_id, doc <span class="kw">in</span> all_docs.items():</span>
<span id="cb39-5"><a href="#cb39-5"></a>    <span class="bu">print</span>(<span class="st">"ID:"</span>, doc_id)</span>
<span id="cb39-6"><a href="#cb39-6"></a>    <span class="bu">print</span>(<span class="st">"Content:"</span>, doc.page_content)</span>
<span id="cb39-7"><a href="#cb39-7"></a>    <span class="bu">print</span>(<span class="st">"Metadata:"</span>, doc.metadata)</span>
<span id="cb39-8"><a href="#cb39-8"></a>    <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ID: 3f6cd2c9-42c5-4e95-a56e-5e5c5fa1da1e
Content: Acme Inc. was founded in 1987 in Helsinki, Finland. It specializes in anti-gravity footwear and
Metadata: {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}
----------------------------------------
ID: 3e61c826-0d6c-4c82-a4f3-e42efde3bf43
Content: rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers",
Metadata: {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}
----------------------------------------
ID: 499a4a3b-9497-4a44-acf0-78b2a09eea04
Content: designed for low-orbit recreational use. As per internal policy, Acme's HR team meets every 2
Metadata: {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}
----------------------------------------
ID: 0770a2d5-f717-424a-a917-b5c63bcd0dfc
Content: weeks to assess wellness metrics of staff based on holographic surveys.
Metadata: {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}
----------------------------------------</code></pre>
</div>
</div>
</section>
<section id="save-reload-faiss-optional" class="level3">
<h3 class="anchored" data-anchor-id="save-reload-faiss-optional">Save &amp; reload FAISS (Optional)</h3>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Save locally</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>vectorstore.save_local(<span class="st">"faiss_index"</span>)</span>
<span id="cb41-3"><a href="#cb41-3"></a></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co"># Reload later</span></span>
<span id="cb41-5"><a href="#cb41-5"></a>new_store <span class="op">=</span> FAISS.load_local(<span class="st">"faiss_index"</span>, OpenAIEmbeddings(), allow_dangerous_deserialization<span class="op">=</span><span class="va">True</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After creating a vectorstore, we can do similarity search using <code>similarity_search()</code> which uses the following process:</p>
<ol type="1">
<li><p>The query is converted into an embedding vector using the same embedding model you used for your documents.</p></li>
<li><p>FAISS computes similarity between the query embedding and all stored embeddings.</p></li>
<li><p>It returns the top-k most similar chunks (Document objects).</p></li>
</ol>
<p>Output = a list of Documents (List[Document]).</p>
<div id="cell-53" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755538753928,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:999,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="f9cde973-a4e3-47b0-a37f-ed0e39bc1eb1">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># extra</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>retrieved_docs <span class="op">=</span> vectorstore.similarity_search(<span class="st">'What was the launch date?'</span>, k <span class="op">=</span> <span class="dv">2</span>) <span class="co"># k is the number of documents to retrieve</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>retrieved_docs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>[Document(id='3e61c826-0d6c-4c82-a4f3-e42efde3bf43', metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers",'),
 Document(id='0770a2d5-f717-424a-a917-b5c63bcd0dfc', metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='weeks to assess wellness metrics of staff based on holographic surveys.')]</code></pre>
</div>
</div>
<p>How similarity is measured?</p>
<p>FAISS uses vector distance metrics (like cosine similarity, L2 distance).</p>
<p>Embeddings of the query and chunks are compared.</p>
<p>Smaller distance = higher similarity.</p>
<p>Another variant:</p>
<p><code>similarity_search_with_score</code>: Also gives similarity score along with the document</p>
<div id="cell-56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755538832131,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:638,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="0093dfe8-db00-4423-fa3b-266db908865c">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>results <span class="op">=</span> vectorstore.similarity_search_with_score(<span class="st">"What was the launch date?"</span>, k<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="cf">for</span> doc, score <span class="kw">in</span> results:</span>
<span id="cb44-3"><a href="#cb44-3"></a>    <span class="bu">print</span>(doc.page_content, score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers", 0.44364873
weeks to assess wellness metrics of staff based on holographic surveys. 0.52889407</code></pre>
</div>
</div>
<p>The previous four steps were to prepare the data for RAG. Now we can do the retrieval.</p>
<p>#5.Create Retriever to retrieve the embeddings from the VectorDB</p>
<p>A retriever is a wrapper around the vector store that defines how to fetch documents given a query.</p>
<div id="cell-59" class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>retriever <span class="op">=</span> vectorstore.as_retriever()</span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co"># or</span></span>
<span id="cb46-3"><a href="#cb46-3"></a>retriever <span class="op">=</span> vectorstore.as_retriever(search_kwargs<span class="op">=</span>{<span class="st">"k"</span>: <span class="dv">3</span>})</span>
<span id="cb46-4"><a href="#cb46-4"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Optional) Retriever is a standardized interface that implements <code>get_relevant_documents(query)</code></p>
<div id="cell-61" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755539229477,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:1146,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="6332bc40-71f9-4d8c-fc69-fa8bceae387e">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>docs <span class="op">=</span> retriever.get_relevant_documents(<span class="st">"What was the launch date?"</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="cf">for</span> d <span class="kw">in</span> docs:</span>
<span id="cb47-3"><a href="#cb47-3"></a>    <span class="bu">print</span>(d.page_content, d.metadata)</span>
<span id="cb47-4"><a href="#cb47-4"></a>    <span class="bu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers", {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}

weeks to assess wellness metrics of staff based on holographic surveys. {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}

designed for low-orbit recreational use. As per internal policy, Acme's HR team meets every 2 {'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}
</code></pre>
</div>
</div>
<p>#6.Combine the LLM and the retriever, and produce results.</p>
<p>Finally, LLM and the retriever are combined into a <code>RetrievalQA</code> chain.</p>
</section>
<section id="retrievalqa" class="level3">
<h3 class="anchored" data-anchor-id="retrievalqa"><code>RetrievalQA</code></h3>
<p>It is a LangChain chain designed specifically for retrieval-augmented generation (RAG).</p>
<p>It combines the following:</p>
<ol type="1">
<li>Retriever: pulls back the most relevant documents from your vector database.</li>
<li>LLM: takes the retrieved documents + user’s query, and generates an answer.</li>
</ol>
<p>So instead of the LLM hallucinating, it grounds its answers on your documents.</p>
<div id="cell-63" class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="im">from</span> langchain.chains <span class="im">import</span> RetrievalQA</span>
<span id="cb49-2"><a href="#cb49-2"></a>qa_chain <span class="op">=</span> RetrievalQA.from_chain_type(llm<span class="op">=</span>llm, retriever<span class="op">=</span>retriever, return_source_documents<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="invokequery-query" class="level3">
<h3 class="anchored" data-anchor-id="invokequery-query"><code>.invoke({"query": query})</code></h3>
<p>Runs the chain.</p>
<ul>
<li><p>Input: a dictionary where the key is “query”.</p></li>
<li><p>Output: dictionary with keys like:</p></li>
<li><ul>
<li>“result” : final LLM-generated answer.</li>
</ul></li>
<li><ul>
<li>“source_documents” (if enabled): list of docs retrieved.</li>
</ul></li>
</ul>
<div id="cell-65" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755539882379,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:1392,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="df8746ed-9c7e-4451-8209-66705f1b90b5">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a>query <span class="op">=</span> <span class="st">"When and where was Acme Inc. founded?"</span></span>
<span id="cb50-2"><a href="#cb50-2"></a>response <span class="op">=</span> qa_chain.invoke({<span class="st">"query"</span>: query})</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="bu">print</span>(response[<span class="st">"result"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Acme Inc. was founded in 1987 in Helsinki, Finland.</code></pre>
</div>
</div>
<div id="cell-66" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;executionInfo&quot;,&quot;value&quot;:{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1755539883796,&quot;user_tz&quot;:-330,&quot;elapsed&quot;:28,&quot;user&quot;:{&quot;displayName&quot;:&quot;anamika chhabra&quot;,&quot;userId&quot;:&quot;17959289708387507018&quot;}}}" data-outputid="ad96f5b5-d13c-4039-ad28-19438812e469">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a><span class="bu">print</span>(response[<span class="st">"source_documents"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[Document(id='3f6cd2c9-42c5-4e95-a56e-5e5c5fa1da1e', metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='Acme Inc. was founded in 1987 in Helsinki, Finland. It specializes in anti-gravity footwear and'), Document(id='3e61c826-0d6c-4c82-a4f3-e42efde3bf43', metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content='rocket-powered pogo sticks. In 2024, Acme released a new product line: "Jet Sneakers",'), Document(id='499a4a3b-9497-4a44-acf0-78b2a09eea04', metadata={'producer': 'PDFium', 'creator': 'PDFium', 'creationdate': 'D:20250730135006', 'source': 'RAG_file.pdf', 'total_pages': 1, 'page': 0, 'page_label': '1'}, page_content="designed for low-orbit recreational use. As per internal policy, Acme's HR team meets every 2")]</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bsc-iitm\.github\.io\/data-science-lab\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week-7/1_Revisiting_langchain.html" class="pagination-link" aria-label="LangChain Basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">LangChain Basics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week-7/3_VectorDBs.html" class="pagination-link" aria-label="Introduction to Vector Databases">
        <span class="nav-page-text">Introduction to Vector Databases</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025 @ IIT Madras</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/bsc-iitm/data-science-lab/blob/master/week-7/2_RAG.ipynb" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bsc-iitm/data-science-lab/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/bsc-iitm/data-science-lab/blob/master/week-7/2_RAG.ipynb" target="_blank" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>